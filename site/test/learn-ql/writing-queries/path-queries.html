
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Creating path queries &#8212; Learn CodeQL</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.25',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Troubleshooting query performance" href="debugging-queries.html" />
    <link rel="prev" title="About data flow analysis" href="../intro-to-data-flow.html" />

<title>CodeQL docs</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="../_static/custom.css" type="text/css" />
<link rel="stylesheet" href="../_static/primer.css" type="text/css" />


  </head>
  <body>
<header class="Header">
    <div class="Header-item--full">
        <a href="../index.html" class="Header-link f2 d-flex flex-items-center">
            <!-- <%= octicon "mark-github", class: "mr-2", height: 32 %> -->
            <svg height="32" class="octicon octicon-mark-github mr-2" viewBox="0 0 16 16" version="1.1" width="32"
                aria-hidden="true">
                <path fill-rule="evenodd"
                    d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z">
                </path>
            </svg>
            <span class="hide-sm">Learning CodeQL</span>
        </a>
    </div>
    <div class="Header-item hide-sm hide-md">
        <form class="search" action="../search.html" method="get">
            <input class="form-control input-dark" type="text" name="q" placeholder="Search" />
            <input class="btn" type="submit" value="Search" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
        </form>
        <script type="text/javascript">$('#searchbox').show(0);</script>

        <div class="clearer"></div>
    </div>
    <div class="Header-item">

        <details class="dropdown details-reset details-overlay d-inline-block">
            <summary class="btn bg-gray-dark text-white border" aria-haspopup="true">
                CodeQL resources
                <div class="dropdown-caret"></div>
            </summary>

            <ul class="dropdown-menu dropdown-menu-se dropdown-menu-dark">
                <div class="dropdown-header">
                    Help docs
                </div>
                <li><a class="dropdown-item" href="https://help.semmle.com/QL/learn-ql/">Learn CodeQL</a></li>
                <li><a class="dropdown-item" href="https://help.semmle.com/codeql/codeql-tools.html">CodeQL tools</a>
                </li>
                <li class="dropdown-divider" role="separator"></li>
                <div class="dropdown-header">
                    Reference docs
                </div>
                <li><a class="dropdown-item" href="https://help.semmle.com/QL/ql-handbook/">QL language reference</a>
                <li><a class="dropdown-item" href="https://help.semmle.com/QL/ql-libraries.html">CodeQL libraries</a>
                <li><a class="dropdown-item" href="https://help.semmle.com/QL/ql-built-in-queries.html">CodeQL
                        queries</a>
                <li class="dropdown-divider" role="separator"></li>
                <div class="dropdown-header">
                    Source files
                </div>
                <li><a class="dropdown-item" href="https://github.com/github/codeql">CodeQL repository</a>
            </ul>
        </details>

    </div>

</header>
<main class="bg-gray-light clearfix">
<nav class="SideNav position-sticky top-0 col-lg-3 col-md-3 float-left p-4 hide-sm hide-md overflow-y-auto">

    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../beginner/ql-tutorials.html">QL tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="writing-queries.html">CodeQL queries</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction-to-queries.html">About CodeQL queries</a></li>
<li class="toctree-l2"><a class="reference internal" href="query-metadata.html">Metadata for CodeQL queries</a></li>
<li class="toctree-l2"><a class="reference internal" href="query-help.html">Query help files</a></li>
<li class="toctree-l2"><a class="reference internal" href="select-statement.html">Defining the results of a query</a></li>
<li class="toctree-l2"><a class="reference internal" href="../locations.html">Providing locations in CodeQL queries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro-to-data-flow.html">About data flow analysis</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Creating path queries</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging-queries.html">Troubleshooting query performance</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cpp/ql-for-cpp.html">CodeQL for C and C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../csharp/ql-for-csharp.html">CodeQL for C#</a></li>
<li class="toctree-l1"><a class="reference internal" href="../go/ql-for-go.html">CodeQL for Go</a></li>
<li class="toctree-l1"><a class="reference internal" href="../java/ql-for-java.html">CodeQL for Java</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javascript/ql-for-javascript.html">CodeQL for JavaScript</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/ql-for-python.html">CodeQL for Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ql-training.html">CodeQL training and variant analysis examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../terminology-note.html">Recent terminology changes</a></li>
</ul>


</nav>


<div class="body col-sm-12 col-md-9 col-lg-9 float-left border-left">

    <div class="hide-lg hide-xl px-4 pt-4">
        
<div class="related" role="navigation" aria-label="related navigation">
    <ul>
        <li class="nav-item nav-item-0"><a href="../index.html">Learn CodeQL</a> &#187;</li>
        <li class="nav-item nav-item-1"><a href="writing-queries.html"
                accesskey="U">CodeQL queries</a> &#187;</li> 
    </ul>
</div>
    </div>

    <article class="p-4 col-lg-10 col-md-10 col-sm-12">
        
  <div class="section" id="creating-path-queries">
<h1>Creating path queries<a class="headerlink" href="#creating-path-queries" title="Permalink to this headline">¶</a></h1>
<p>You can create path queries to visualize the flow of information through a codebase.</p>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Security researchers are particularly interested in the way that information flows in a program. Many vulnerabilities are caused by seemingly benign data flowing to unexpected locations, and being used in a malicious way.
Path queries written with CodeQL are particularly useful for analyzing data flow as they can be used to track the path taken by a variable from its possible starting points (<code class="docutils literal"><span class="pre">source</span></code>) to its possible end points (<code class="docutils literal"><span class="pre">sink</span></code>).
To model paths, your query must provide information about the <code class="docutils literal"><span class="pre">source</span></code> and the <code class="docutils literal"><span class="pre">sink</span></code>, as well as the data flow steps that link them.</p>
<p>This topic provides information on how to structure a path query file so you can explore the paths associated with the results of data flow analysis.</p>
<blockquote class="pull-quote">
<div><p>Note</p>
<p>The alerts generated by path queries are displayed by default in <a class="reference external" href="https://lgtm.com">LGTM</a> and included in the results generated using the <a class="reference external" href="https://help.semmle.com/codeql/codeql-cli.html">CodeQL CLI</a>. You can also view the path explanations generated by your path query <a class="reference external" href="https://lgtm.com/help/lgtm/exploring-data-flow-paths">directly in LGTM</a> or in the CodeQL <a class="reference external" href="https://help.semmle.com/codeql/codeql-for-vscode.html">extension for VS Code</a>.</p>
</div></blockquote>
<p>To learn more about modeling data flow with CodeQL, see “<a class="reference internal" href="../intro-to-data-flow.html"><span class="doc">About data flow analysis</span></a>.”
For more language-specific information on analyzing data flow, see:</p>
<ul class="simple">
<li>“<a class="reference internal" href="../cpp/dataflow.html"><span class="doc">Analyzing data flow in C/C++</span></a>”</li>
<li>“<a class="reference internal" href="../csharp/dataflow.html"><span class="doc">Analyzing data flow in C#</span></a>”</li>
<li>“<a class="reference internal" href="../java/dataflow.html"><span class="doc">Analyzing data flow in Java</span></a>”</li>
<li>“<a class="reference internal" href="../javascript/dataflow.html"><span class="doc">Analyzing data flow in JavaScript/TypeScript</span></a>”</li>
<li>“<a class="reference internal" href="../python/taint-tracking.html"><span class="doc">Analyzing data flow and tracking tainted data in Python</span></a>”</li>
</ul>
<div class="section" id="path-query-examples">
<h3>Path query examples<a class="headerlink" href="#path-query-examples" title="Permalink to this headline">¶</a></h3>
<p>The easiest way to get started writing your own path query is to modify one of the existing queries. Visit the links below to see all the built-in path queries:</p>
<ul class="simple">
<li><a class="reference external" href="https://help.semmle.com/wiki/label/CCPPOBJ/path-problem">C/C++ path queries</a></li>
<li><a class="reference external" href="https://help.semmle.com/wiki/label/CSHARP/path-problem">C# path queries</a></li>
<li><a class="reference external" href="https://help.semmle.com/wiki/label/java/path-problem">Java path queries</a></li>
<li><a class="reference external" href="https://help.semmle.com/wiki/label/js/path-problem">JavaScript path queries</a></li>
<li><a class="reference external" href="https://help.semmle.com/wiki/label/python/path-problem">Python path queries</a></li>
</ul>
<p>The Security Lab researchers have used path queries to find security vulnerabilities in various open source projects. To see articles describing how these queries were written, as well as other posts describing other aspects of security research such as exploiting vulnerabilities, see the <a class="reference external" href="https://securitylab.github.com/research">GitHub Security Lab website</a>.</p>
</div>
</div>
<div class="section" id="constructing-a-path-query">
<h2>Constructing a path query<a class="headerlink" href="#constructing-a-path-query" title="Permalink to this headline">¶</a></h2>
<p>Path queries require certain metadata, query predicates, and <code class="docutils literal"><span class="pre">select</span></code> statement structures.
Many of the built-in path queries included in CodeQL follow a simple structure, which depends on how the language you are analyzing is modeled with CodeQL.</p>
<p>For C/C++, C#, Java, and JavaScript you should use the following template:</p>
<div class="highlight-ql"><div class="highlight"><pre><span></span><span class="cp">/**</span>
<span class="cp"> * ...</span>
<span class="cp"> * @kind path-problem</span>
<span class="cp"> * ...</span>
<span class="cp"> */</span>

<span class="k">import</span> <span class="o">&lt;</span><span class="n">language</span><span class="o">&gt;</span>
<span class="k">import</span> <span class="n">DataFlow</span><span class="o">::</span><span class="n">PathGraph</span>
<span class="p">...</span>

<span class="k">from</span> <span class="n">Configuration</span> <span class="n">config</span><span class="p">,</span> <span class="n">DataFlow</span><span class="o">::</span><span class="n">PathNode</span> <span class="n">source</span><span class="p">,</span> <span class="n">DataFlow</span><span class="o">::</span><span class="n">PathNode</span> <span class="n">sink</span>
<span class="k">where</span> <span class="n">config</span><span class="p">.</span><span class="n">hasFlowPath</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">sink</span><span class="p">)</span>
<span class="k">select</span> <span class="n">sink</span><span class="p">.</span><span class="n">getNode</span><span class="p">(),</span> <span class="n">source</span><span class="p">,</span> <span class="n">sink</span><span class="p">,</span> <span class="s">&quot;&lt;message&gt;&quot;</span>
</pre></div>
</div>
<p>Where:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">DataFlow::Pathgraph</span></code> is the path graph module you need to import from the standard CodeQL libraries.</li>
<li><code class="docutils literal"><span class="pre">source</span></code> and <code class="docutils literal"><span class="pre">sink</span></code> are nodes on the <a class="reference external" href="https://en.wikipedia.org/wiki/Path_graph">path graph</a>, and <code class="docutils literal"><span class="pre">DataFlow::PathNode</span></code> is their type.</li>
<li><code class="docutils literal"><span class="pre">Configuration</span></code> is a class containing the predicates which define how data may flow between the <code class="docutils literal"><span class="pre">source</span></code> and the <code class="docutils literal"><span class="pre">sink</span></code>.</li>
</ul>
<p>For Python you should use a slightly different template:</p>
<div class="highlight-ql"><div class="highlight"><pre><span></span><span class="cp">/**</span>
<span class="cp"> * ...</span>
<span class="cp"> * @kind path-problem</span>
<span class="cp"> * ...</span>
<span class="cp"> */</span>

<span class="k">import</span> <span class="n">python</span>
<span class="k">import</span> <span class="n">semmle</span><span class="p">.</span><span class="n">python</span><span class="p">.</span><span class="n">security</span><span class="p">.</span><span class="n">Paths</span>
<span class="p">...</span>

<span class="k">from</span> <span class="n">TaintedPathSource</span> <span class="n">source</span><span class="p">,</span> <span class="n">TaintedPathSink</span> <span class="n">sink</span>
<span class="k">where</span> <span class="n">source</span><span class="p">.</span><span class="n">flowsTo</span><span class="p">(</span><span class="n">sink</span><span class="p">)</span>
<span class="k">select</span> <span class="n">sink</span><span class="p">.</span><span class="n">getNode</span><span class="p">(),</span> <span class="n">source</span><span class="p">,</span> <span class="n">sink</span><span class="p">,</span> <span class="s">&quot;&lt;message&gt;&quot;</span>
</pre></div>
</div>
<p>Where:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">semmle.python.security.Paths</span></code> is the path graph module imported from the standard CodeQL libraries.</li>
<li><code class="docutils literal"><span class="pre">source</span></code> and <code class="docutils literal"><span class="pre">sink</span></code> are nodes on the path graph, <code class="docutils literal"><span class="pre">TaintedPathSource</span> <span class="pre">source</span></code> and <code class="docutils literal"><span class="pre">TaintedPathSink</span></code> are their respective types. Note, you do not need to declare a configuration class to define the data flow from the <code class="docutils literal"><span class="pre">source</span></code> to the <code class="docutils literal"><span class="pre">sink</span></code> in a Python path query.</li>
</ul>
<p>The following sections describe the main requirements for a valid path query.</p>
<div class="section" id="path-query-metadata">
<h3>Path query metadata<a class="headerlink" href="#path-query-metadata" title="Permalink to this headline">¶</a></h3>
<p>Path query metadata must contain the property <code class="docutils literal"><span class="pre">&#64;kind</span> <span class="pre">path-problem</span></code>–this ensures that query results are interpreted and displayed correctly.
The other metadata requirements depend on how you intend to run the query. For more information, see “<a class="reference internal" href="query-metadata.html"><span class="doc">Metadata for CodeQL queries</span></a>.”</p>
</div>
<div class="section" id="generating-path-explanations">
<h3>Generating path explanations<a class="headerlink" href="#generating-path-explanations" title="Permalink to this headline">¶</a></h3>
<p>In order to generate path explanations, your query needs to compute a <a class="reference external" href="https://en.wikipedia.org/wiki/Path_graph">path graph</a>.
To do this you need to define a <a class="reference external" href="https://help.semmle.com/QL/ql-handbook/queries.html#query-predicates">query predicate</a> called <code class="docutils literal"><span class="pre">edges</span></code> in your query.
This predicate defines the edge relations of the graph you are computing, and it is used to compute the paths related to each result that your query generates.
You can import a predefined <code class="docutils literal"><span class="pre">edges</span></code> predicate from a path graph module in one of the standard data flow libraries. In addition to the path graph module, the data flow libraries contain the other <code class="docutils literal"><span class="pre">classes</span></code>, <code class="docutils literal"><span class="pre">predicates</span></code>, and <code class="docutils literal"><span class="pre">modules</span></code> that are commonly used in data flow analysis. The import statement to use depends on the language that you are analyzing.</p>
<p>For C/C++, C#, Java, and JavaScript you would use:</p>
<div class="highlight-ql"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="n">DataFlow</span><span class="o">::</span><span class="n">PathGraph</span>
</pre></div>
</div>
<p>This statement imports the <code class="docutils literal"><span class="pre">PathGraph</span></code> module from the data flow library (<code class="docutils literal"><span class="pre">DataFlow.qll</span></code>), in which <code class="docutils literal"><span class="pre">edges</span></code> is defined.</p>
<p>For Python, the <code class="docutils literal"><span class="pre">Paths</span></code> module contains the <code class="docutils literal"><span class="pre">edges</span></code> predicate:</p>
<div class="highlight-ql"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="n">semmle</span><span class="p">.</span><span class="n">python</span><span class="p">.</span><span class="n">security</span><span class="p">.</span><span class="n">Paths</span>
</pre></div>
</div>
<p>You can also import libraries specifically designed to implement data flow analysis in various common frameworks and environments, and many additional libraries are included with CodeQL. To see examples of the different libraries used in data flow analysis, see the links to the built-in queries above or browse the <a class="reference external" href="https://help.semmle.com/QL/ql-libraries.html">standard libraries</a>.</p>
<p>For all languages, you can also optionally define a <code class="docutils literal"><span class="pre">nodes</span></code> query predicate, which specifies the nodes of the path graph that you are interested in. If <code class="docutils literal"><span class="pre">nodes</span></code> is defined, only edges with endpoints defined by these nodes are selected. If <code class="docutils literal"><span class="pre">nodes</span></code> is not defined, you select all possible endpoints of <code class="docutils literal"><span class="pre">edges</span></code>.</p>
<div class="section" id="defining-your-own-edges-predicate">
<h4>Defining your own <code class="docutils literal"><span class="pre">edges</span></code> predicate<a class="headerlink" href="#defining-your-own-edges-predicate" title="Permalink to this headline">¶</a></h4>
<p>You can also define your own <code class="docutils literal"><span class="pre">edges</span></code> predicate in the body of your query. It should take the following form:</p>
<div class="highlight-ql"><div class="highlight"><pre><span></span><span class="kr">query </span><span class="k">predicate</span> <span class="n">edges</span><span class="p">(</span><span class="n">PathNode</span> <span class="n">a</span><span class="p">,</span> <span class="n">PathNode</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
<span class="cp">/** Logical conditions which hold if `(a,b)` is an edge in the data flow graph */</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For more examples of how to define an <code class="docutils literal"><span class="pre">edges</span></code> predicate, visit the <a class="reference external" href="https://help.semmle.com/QL/ql-libraries.html">standard CodeQL libraries</a> and search for <code class="docutils literal"><span class="pre">edges</span></code>.</p>
</div>
</div>
<div class="section" id="declaring-sources-and-sinks">
<h3>Declaring sources and sinks<a class="headerlink" href="#declaring-sources-and-sinks" title="Permalink to this headline">¶</a></h3>
<p>You must provide information about the <code class="docutils literal"><span class="pre">source</span></code> and <code class="docutils literal"><span class="pre">sink</span></code> in your path query. These are objects that correspond to the nodes of the paths that you are exploring.
The name and the type of the <code class="docutils literal"><span class="pre">source</span></code> and the <code class="docutils literal"><span class="pre">sink</span></code> must be declared in the <code class="docutils literal"><span class="pre">from</span></code> statement of the query, and the types must be compatible with the nodes of the graph computed by the <code class="docutils literal"><span class="pre">edges</span></code> predicate.</p>
<p>If you are querying C/C++, C#, Java, or JavaScript code (and you have used <code class="docutils literal"><span class="pre">import</span> <span class="pre">DataFlow::PathGraph</span></code> in your query), the definitions of the <code class="docutils literal"><span class="pre">source</span></code> and <code class="docutils literal"><span class="pre">sink</span></code> are accessed via the <code class="docutils literal"><span class="pre">Configuration</span></code> class in the data flow library. You should declare all three of these objects in the <code class="docutils literal"><span class="pre">from</span></code> statement.
For example:</p>
<div class="highlight-ql"><div class="highlight"><pre><span></span><span class="k">from</span> <span class="n">Configuration</span> <span class="n">config</span><span class="p">,</span> <span class="n">DataFlow</span><span class="o">::</span><span class="n">PathNode</span> <span class="n">source</span><span class="p">,</span> <span class="n">DataFlow</span><span class="o">::</span><span class="n">PathNode</span> <span class="n">sink</span>
</pre></div>
</div>
<p>The configuration class is accessed by importing the data flow library. This class contains the predicates which define how data flow is treated in the query:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">isSource()</span></code> defines where data may flow from.</li>
<li><code class="docutils literal"><span class="pre">isSink()</span></code> defines where data may flow to.</li>
</ul>
<p>For more information on using the configuration class in your analysis see the sections on global data flow in “<a class="reference internal" href="../cpp/dataflow.html"><span class="doc">Analyzing data flow in C/C++</span></a>” and “<a class="reference internal" href="../csharp/dataflow.html"><span class="doc">Analyzing data flow in C#</span></a>.”</p>
<p>You can also create a configuration for different frameworks and environments by extending the <code class="docutils literal"><span class="pre">Configuration</span></code> class. For more information, see “<a class="reference external" href="https://help.semmle.com/QL/ql-handbook/types.html#defining-a-class">Types</a>” in the QL language reference.</p>
<p>If you are querying Python code (and you have used <code class="docutils literal"><span class="pre">import</span> <span class="pre">semmle.python.security.Paths</span></code> in your query) you should declare <code class="docutils literal"><span class="pre">TaintedPathSource</span> <span class="pre">source,</span> <span class="pre">TaintedPathSink</span> <span class="pre">sink</span></code> in your <code class="docutils literal"><span class="pre">from</span></code> statement. You do not need to declare a <code class="docutils literal"><span class="pre">Configuration</span></code> class as the definitions of the <code class="docutils literal"><span class="pre">TaintedPathSource</span></code> and <code class="docutils literal"><span class="pre">TaintedPathSink</span></code> contain all of the type information that is required:</p>
<div class="highlight-ql"><div class="highlight"><pre><span></span><span class="k">from</span> <span class="n">TaintedPathSource</span> <span class="n">source</span><span class="p">,</span> <span class="n">TaintedPathSink</span> <span class="n">sink</span>
</pre></div>
</div>
<p>You can extend your query by adding different sources and sinks by either defining them in the query, or by importing predefined sources and sinks for specific frameworks and libraries. See the <a class="reference external" href="https://help.semmle.com/wiki/label/python/path-problem">Python path queries</a> for further details.</p>
</div>
<div class="section" id="defining-flow-conditions">
<h3>Defining flow conditions<a class="headerlink" href="#defining-flow-conditions" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">where</span></code> clause defines the logical conditions to apply to the variables declared in the <code class="docutils literal"><span class="pre">from</span></code> clause to generate your results.
This clause can use <a class="reference external" href="https://help.semmle.com/QL/ql-handbook/expressions.html#aggregations">aggregations</a>, <a class="reference external" href="https://help.semmle.com/QL/ql-handbook/predicates.html">predicates</a>, and logical <a class="reference external" href="https://help.semmle.com/QL/ql-handbook/formulas.html">formulas</a> to limit the variables of interest to a smaller set which meet the defined conditions.</p>
<p>When writing a path queries, you would typically include a predicate that holds only if data flows from the <code class="docutils literal"><span class="pre">source</span></code> to the <code class="docutils literal"><span class="pre">sink</span></code>.</p>
<p>For C/C++, C#, Java or JavaScript, you would use the <code class="docutils literal"><span class="pre">hasFlowPath</span></code> predicate to define flow from the <code class="docutils literal"><span class="pre">source</span></code> to the <code class="docutils literal"><span class="pre">sink</span></code> for a given <code class="docutils literal"><span class="pre">Configuration</span></code>:</p>
<div class="highlight-ql"><div class="highlight"><pre><span></span><span class="k">where</span> <span class="n">config</span><span class="p">.</span><span class="n">hasFlowPath</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">sink</span><span class="p">)</span>
</pre></div>
</div>
<p>For Python, you would simply use the <code class="docutils literal"><span class="pre">flowsTo</span></code> predicate to define flow from the <code class="docutils literal"><span class="pre">source</span></code> to the <code class="docutils literal"><span class="pre">sink</span></code>:</p>
<div class="highlight-ql"><div class="highlight"><pre><span></span><span class="k">where</span> <span class="n">source</span><span class="p">.</span><span class="n">flowsTo</span><span class="p">(</span><span class="n">sink</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="select-clause">
<h3>Select clause<a class="headerlink" href="#select-clause" title="Permalink to this headline">¶</a></h3>
<p>Select clauses for path queries consist of four ‘columns’, with the following structure:</p>
<div class="highlight-ql"><div class="highlight"><pre><span></span><span class="k">select</span> <span class="n">element</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">sink</span><span class="p">,</span> <span class="kt">string</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">element</span></code> and <code class="docutils literal"><span class="pre">string</span></code> columns represent the location of the alert and the alert message respectively, as explained in “<a class="reference internal" href="introduction-to-queries.html"><span class="doc">About CodeQL queries</span></a>.” The second and third columns, <code class="docutils literal"><span class="pre">source</span></code> and <code class="docutils literal"><span class="pre">sink</span></code>, are nodes on the path graph selected by the query.
Each result generated by your query is displayed at a single location in the same way as an alert query. Additionally, each result also has an associated path, which can be viewed in LGTM or in the <a class="reference external" href="https://help.semmle.com/codeql/codeql-for-vscode.html">CodeQL extension for VS Code</a>.</p>
<p>The <code class="docutils literal"><span class="pre">element</span></code> that you select in the first column depends on the purpose of the query and the type of issue that it is designed to find. This is particularly important for security issues. For example, if you believe the <code class="docutils literal"><span class="pre">source</span></code> value to be globally invalid or malicious it may be best to display the alert at the <code class="docutils literal"><span class="pre">source</span></code>. In contrast, you should consider displaying the alert at the <code class="docutils literal"><span class="pre">sink</span></code> if you believe it is the element that requires sanitization.</p>
<p>The alert message defined in the final column in the <code class="docutils literal"><span class="pre">select</span></code> statement can be developed to give more detail about the alert or path found by the query using links and placeholders. For more information, see “<a class="reference internal" href="select-statement.html"><span class="doc">Defining the results of a query</span></a>.”</p>
</div>
<div class="section" id="further-reading">
<h3>Further reading<a class="headerlink" href="#further-reading" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>“<a class="reference external" href="https://help.semmle.com/codeql/codeql-for-vscode/procedures/exploring-paths.html">Exploring data flow with path queries</a>”</li>
<li><a class="reference external" href="https://github.com/github/codeql">CodeQL repository</a></li>
</ul>
</div>
</div>
</div>


    </article>

    <!-- GitHub footer, with links to terms and privacy statement -->
    <div class="px-3 px-md-6 f6 py-4 d-sm-flex flex-justify-between flex-row-reverse flex-items-center border-top">
        <ul class="list-style-none d-flex flex-items-center mb-3 mb-sm-0 lh-condensed-ultra">
            <li class="mr-3">
                <a href="https://twitter.com/github" title="GitHub on Twitter" style="color: #959da5;">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 273.5 222.3" class="d-block" height="18">
                        <path
                            d="M273.5 26.3a109.77 109.77 0 0 1-32.2 8.8 56.07 56.07 0 0 0 24.7-31 113.39 113.39 0 0 1-35.7 13.6 56.1 56.1 0 0 0-97 38.4 54 54 0 0 0 1.5 12.8A159.68 159.68 0 0 1 19.1 10.3a56.12 56.12 0 0 0 17.4 74.9 56.06 56.06 0 0 1-25.4-7v.7a56.11 56.11 0 0 0 45 55 55.65 55.65 0 0 1-14.8 2 62.39 62.39 0 0 1-10.6-1 56.24 56.24 0 0 0 52.4 39 112.87 112.87 0 0 1-69.7 24 119 119 0 0 1-13.4-.8 158.83 158.83 0 0 0 86 25.2c103.2 0 159.6-85.5 159.6-159.6 0-2.4-.1-4.9-.2-7.3a114.25 114.25 0 0 0 28.1-29.1"
                            fill="currentColor"></path>
                    </svg>
                </a>
            </li>
            <li class="mr-3">
                <a href="https://www.facebook.com/GitHub" title="GitHub on Facebook" style="color: #959da5;">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.3 15.4" class="d-block" height="18">
                        <path
                            d="M14.5 0H.8a.88.88 0 0 0-.8.9v13.6a.88.88 0 0 0 .8.9h7.3v-6h-2V7.1h2V5.4a2.87 2.87 0 0 1 2.5-3.1h.5a10.87 10.87 0 0 1 1.8.1v2.1h-1.3c-1 0-1.1.5-1.1 1.1v1.5h2.3l-.3 2.3h-2v5.9h3.9a.88.88 0 0 0 .9-.8V.8a.86.86 0 0 0-.8-.8z"
                            fill="currentColor"></path>
                    </svg>
                </a>
            </li>
            <li class="mr-3">
                <a href="https://www.youtube.com/github" title="GitHub on YouTube" style="color: #959da5;">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.17 13.6" class="d-block" height="16">
                        <path
                            d="M18.77 2.13A2.4 2.4 0 0 0 17.09.42C15.59 0 9.58 0 9.58 0a57.55 57.55 0 0 0-7.5.4A2.49 2.49 0 0 0 .39 2.13 26.27 26.27 0 0 0 0 6.8a26.15 26.15 0 0 0 .39 4.67 2.43 2.43 0 0 0 1.69 1.71c1.52.42 7.5.42 7.5.42a57.69 57.69 0 0 0 7.51-.4 2.4 2.4 0 0 0 1.68-1.71 25.63 25.63 0 0 0 .4-4.67 24 24 0 0 0-.4-4.69zM7.67 9.71V3.89l5 2.91z"
                            fill="currentColor"></path>
                    </svg>
                </a>
            </li>
            <li class="mr-3 flex-self-start">
                <a href="https://www.linkedin.com/company/github" title="GitHub on Linkedin" style="color: #959da5;">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19 18" class="d-block" height="18">
                        <path
                            d="M3.94 2A2 2 0 1 1 2 0a2 2 0 0 1 1.94 2zM4 5.48H0V18h4zm6.32 0H6.34V18h3.94v-6.57c0-3.66 4.77-4 4.77 0V18H19v-7.93c0-6.17-7.06-5.94-8.72-2.91z"
                            fill="currentColor"></path>
                    </svg>
                </a>
            </li>
            <li>
                <a href="https://github.com/github" title="GitHub's organization" style="color: #959da5;">
                    <svg version="1.1" width="20" height="20" viewBox="0 0 16 16" class="octicon octicon-mark-github"
                        aria-hidden="true">
                        <path fill-rule="evenodd"
                            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
                        </path>
                    </svg>
                </a>
            </li>
        </ul>
        <ul class="list-style-none d-flex text-gray">
            <li class="mr-3">&copy; 2020 GitHub, Inc.</li>
            <li class="mr-3"><a
                    href="https://docs.github.com/github/site-policy/github-terms-of-service"
                    class="link-gray">Terms </a></li>
            <li><a href="https://docs.github.com/github/site-policy/github-privacy-statement"
                    class="link-gray">Privacy </a></li>
        </ul>
    </div>
</div>
</main>

<script type="text/javascript">
    $(document).ready(function () {
        $(".toggle > *").hide();
        $(".toggle .name").show();
        $(".toggle .name").click(function () {
            $(this).parent().children().not(".name").toggle(400);
            $(this).parent().children(".name").toggleClass("open");
        })
    });
</script>

  </body>
</html>